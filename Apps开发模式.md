好像很多自带应用都非常“轻快”，但是很多国产应用都比较“重”。手机体验都以app为主，而电脑目前还是以浏览器为主，这两者多大差异？我们用到的、用不到的所有的软件/应用，都是用什么语言开发的？开发的逻辑和框架又有什么区别与联系呢？本文给你答案。



**目录**

**- 01 系统、语言、API**

  **-- \**万\******变不离其宗**

  **--** **不同的语言，不同的API**

**- 02 跨平台App花样实现**

  **-- \**最复杂的App—浏览器\****

  ***\*-- \*\*\*\*几种跨平台App实现\*\*\*\*\****

**- 0\**3 Web-App的利与弊\****

  **-- Web-App的优势**

  **-- Web-App的局限**

**
**

**01 系统、语言、API**

------

**万变不离其宗**

我对计算机充满好奇，执迷于弄清楚操作系统到底是怎么工作的，在我浅显的了解了操作系统的诸多部分之后，知道了操作系统提供了很多接口（API），可以理解为一堆函数（Function）。

这些函数我们可以调用来实现我们想要实现的功能，而一组功能的集合，就是应用程序（Application）了。然而就在我认为自己领悟一切的时候，却发现这个世界上的App花样百出（我指的是实现方式，而不是功能与界面）。

我懵了，系统就这么几个（IOS、Mac、Linux、Android、Windows），而且IOS和Mac基本用类似的API，那我要是写一个跨平台软件（上述操作系统都可以运行），应该就是选择一门语言比如`C++`，然后用各个操作系统的API（虽然各个操作系统提供的API不一样，但大同小异，实现方式都基本一样，比如文件系统，比如网络协议接口等）实现我想要的功能，就做好了呗。万变不离其宗嘛~ NO！没这么简单。



**不同的语言，不同的API**

操作系统内核基本都是`C`实现的，所以也就为是`C/C++`提供了“最底层”的API，当然现代操作系统是很人性化的，操作系统厂商和开源社区为各种语言共同开发更加“高级”易用的系统API，这也就是为什么理论上用任何语言都可以利用上多数系统API来实现一个复杂的“大型”App。

但操作系统厂商（Apple、Google、Microsoft）侧重的语言不同，甚至都有自己的“御用”语言，当然API对这门语言的适配更好，这就表现为：使用该语言的API用相对高效的代码，实现最新的系统支持的功能，且能保持较高的性能（代码执行效率）。比如Apple（IOS&MacOS）的御用语言`Swift`、Android的御用语言`Java`、Windows的御用语言`C#`等。



**GUI（Graphical User Interface）**

提到App我们当然要提到GUI（图形界面）的实现，也就是我们看到的这一切。因为在很久以前，计算机没有显示屏，也是可以计算的。而现在，可视化的窗口、视频、3D模型成为体验的主体。但要注意的是，这“仅仅”是众多API的一组，比如网络API等。

这一切的核心理念都来自Pixar工作室和施乐公司，而这却都指向了乔布斯，就是另一端传奇的故事了。Anyway，我们平常所说的所谓GUI开发，仅仅是`UI`之上的开发，而几乎看不见一点点的`G`。**`GUI`是`G`+`UI`，这个Graphics，包含着在最底层计算机是怎么处理“图像”的，也就是把各种各样的“形状”、“颜色”、“3D信息”转化成最终像素的过程。**

这一过程的原理，往往会出现在《计算图形学》，3D建模等方向，而在`UI`设计方向，好像少有人懂。其实这恰恰是计算机行业成功的表现，就是封装，一层层的抽象，让开发者不知道具体实现的底层细节，来开发更宏大的项目。比如`Linux`中`GUI`的`G`就是`X Window`，但这还需要显卡、显卡驱动及显卡API如`OpenGL`；而在Mac上，`OpenGL`和`X Window`对应的就是`Metal`和`AppKit`，当然Apple在近几年逐渐使用IOS和MacOS统一的`SwiftUI`来代替MacOS的`AppKit`和IOS的`UIKit`。总之，我们平常所说的`GUI`：只是操作系统提供了`G`，并又在`G`的API上封装了`UI`这个API，我们利用`UI`的API写窗口和主逻辑代码的链接关系（一般由Signal表示）。这些API的复杂关系，在我之前的文章——`OS科普`中可以了解。

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)



**02 跨平台App花样实现**

------

那我们回到最开始的问题：做一个跨平台的App，怎么实现？怎么又快又好地实现？

能把系统底层API利用的淋漓尽致、同时又把性能发挥到极致的跨平台App，浏览器当之无愧，Chrome乃当今最流行的浏览器，就以它为例子，看看这个`C++`写的极致跨平台App是怎么做到的。



**最复杂的App—浏览器**

浏览器最核心的就是浏览器内核，现代浏览器内核绝大多数都是基于`Webkit`——Apple的一个开源项目，Chrome内核（Blink）同样基于此实现了更多特性，如今Windows已经将默认浏览器设为Chrome内核的Edge，让浏览器内核市场空前统一（国内大部分浏览器都是Chrome内核，腾讯的X5也是在`Webkit`基础上开发的），这一现象有利有弊，最大的好处就是让跨平台网站开发变得更加容易。

![img](https://mmbiz.qpic.cn/mmbiz_png/Cwiafoqq2kOZGWbS9SaTNq8QSvMhn1qPL1ao5Zoe2ZEic573uMx5E2WoxneyNq23oflhqsFZyEXQ9uYNz6L7VYIQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

上图“抄”的到处可见的一张`Webkit`架构图。可以看到，它几乎构建在所有系统API之上，之后对`HTML`、`CSS`、`JavaScript`做了封装，比如完整的`JavaScript`解释器、网络栈等，让前端开发者能快速高效的利用这些“简单”的API，做出漂亮功能强大的网页。

看到这里，应该有点启发了？**现代浏览器内核相当于在不同操作系统不同语言的API上构建了一个只需要`HTML`、`CSS`、`JavaScript`的完美跨平台体系！**这这这，**这就是Web-App的由来——基于浏览器内核的跨平台桌面应用**。只要你会写网页，就会开发跨平台App；只要你会这么简单的跨平台App，你就会写很棒的网页。Wow！



**几种跨平台App实现**

跨平台做app，当然可以只用一门较为高效的主流语言，比如`C++`或`Java`，性能高，后期维护方便，但是有一个重要的问题，各平台都有“适合”的语言不仅或根本不是其语言特性的优势特别巨大，而是其背后的母公司API对这门语言的优化、和围绕这门语言的整个生态。

当然高效API和生态的发展也的确证明这门语言特性有一定优势，比如当年`Java`之于`C++`、比如`Swift`之于`Objective-c`、比如`Python`和`Javascript`等解释语言的发展。

语言太多，平台就那么几个：**Apple**、**Google**、**Linux**、**Microsoft**、**Web-Server**。每个平台都有自己的开发“生态”，这就决定在其生态必然会获得最高效的开发体验，前提是，你不跨平台。

软件市场有个很普遍的现象：很多功能强大的跨平台应用，多数都存在更新慢、适配慢的问题；而很多某平台专有的App，往往更新节奏很快。当然大公司的跨平台app也可以更新很快，这就取决于“钞能力”和重视程度了。所以，Web-App可能不会成为下一个发展潮流，但可以有一席之地。

具体如`C++`、`Java`、Web写的跨平台应用，`GUI`都用什么库呢（其实还会用到葛总第三方库，但是`GUI`是十分复杂的，所以单独拿出来说一下）：当然，Web本身就是基于浏览器的，当然就是用的浏览器的`GUI`渲染，所以下面的Electron是一个基于Web的开发套件。

#### **Qt-C++**

`C/C++`常被用于开发大型高效的软件或系统：基本各大操作系统、`Git`、`CPython`和数不尽数的大型App。这些App有大公司做后盾，往往正面硬刚底层API来做优化，但GUI很多都用`Qt`库。很多著名的App：

- Deepin的`GUI`

- Ubuntu的`GUI`

- WPS的`GUI`

- Autodesk Maya的`GUI`

- DaVinci Resolve的`GUI`

- ......

  

#### **Swing-Java**

没错，Java也可以开发软件。Intellij就是Java的Swing库写的界面，但这好像不是个好的选择：Java性能不如C++、开发效率远不如接下来要讲的Web-App。

#### **Electron-Web**

上面讲到，理论上基于浏览器我们用`HTML`、`CSS`、`JavaScript`就可以写一个跨平台的App，那么总不能写好的App用浏览器打开吧（有些Low）。所有有人帮我们做好了已经：Nodejs（继承了JS解释器等一系列浏览器内核的必要元素），在加上Electron（基于Nodejs进一步抽象实现一个看起来像App的网页！）。Electron是GitHub发起的非常成功的开源项目，这种开发框架必然会导致App性能损失、体量巨大等问题，但是对于快速发展的互联网时代来说，开发周期就是一切。（对此褒贬不一）

在GitHub被Microsoft收购后，Windows出现了不少惊艳的“亲儿子”（个人认为有因果关系），其中VSCode完全“打压”了Sublime和Atom，成为最受欢迎代码编辑器。而它，仅仅是Electron成功案例的冰山一角。WhatsApp、Atom、Slack等一堆应用都是Electron开发的。

界面现代、生态繁盛、开发周期极快是Electron的核心竞争力，而这也是所有Web-App的优势，微信小程序就是又一个典型案例：写过微信小程序的人应该知道就是换壳的`HTML`+`JavaScript`。这种开发模式也使得微信小程序市场极速膨胀，让微信成为一个“轻量”的App Store。Wow Again！



**03 Web-App的利与弊**

------

这部分有点跑题，我想谈一谈Web-App这一趋势，当然这不限于国内软件市场。

**Web-App的优势**

互联网的看似快速发展，但变化不如不变多，计算机行业慢慢的变成“传统行业”，从制备工艺的“挤牙膏”、到芯片架构的“挤牙膏”、到操作系统的“挤牙膏”，再到互联网产业结构的“挤牙膏”，其实所谓的挤牙膏就是在趋于稳定罢了，就像是很多制造业百变不变，这牙膏都是纳米级别的了。计算机还将发展，但在下一个基础学科突破之前，应该是在应用层的发展，比如5G和ARM芯片带来的高效能与低延迟会催生新的软件形态，从而出现新的商业模式。而这种快速的开发模式也会是一个催化剂。

**Web-App的局限**

但是这同样有些弊端。变中有不变，总有些底层的架构一旦有“微小”的改变，就能掀起应用层的巨浪。这世界，尤其是中国，还是需要有人敢啃硬骨头，厚积薄发，从而在计算机行业兴风作浪一回的。比如华为的5G、Apple的ARM，Deepin操作系统：华为被美国打压，发展吃力；ARM兼容性和生态未知；Deepin的Bug太多，Windows用户基数巨大；依然很多人不看好，我也不敢也不能保证这几个项目在5年后会有重大突破，引领时代。

但是，他们有个共同的特点，就是敢啃硬骨头。这必然是有代价的，这也不可能成为多数的选择，谁都知道ARM作为笔记本芯片会更高效；谁都知道5G会带来无限想象；谁都知道国内软件生态差；但多数总是在追求短平快，不敢不想也不必在硬骨头上冒风险。但这种精神不能亡，这个世界需要，中国也需要。